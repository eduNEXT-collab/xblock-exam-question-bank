{% load i18n %}

{% if unit_title and show_title %}
  <h2 class="hd hd-2 unit-title">{{ unit_title }}</h2>
{% endif %}

<div class="exam-info-panel">
    <div class="attempt-info">
        {% if current_grade >= minimum_passing_score or not is_attempting %}
        <p class="current-grade">
            <strong>{% trans "Grade:" %}</strong>
            {{ current_grade|floatformat:1 }}%
            {% if current_grade >= minimum_passing_score %}
                <span class="grade-status passed">âœ“ {% trans "Passed" %}</span>
            {% else %}
                <span class="grade-status not-passed">{% trans "Not Passed" %}</span>
            {% endif %}
        </p>
        {% endif %}

        {% if current_attempt > 0 and not is_attempting %}
        <p class="attempt-counter">
            <strong>{% trans "Attempt:" %}</strong>
            {% if max_attempts == -1 %}
                {{ current_attempt }} (unlimited)
            {% else %}
                {{ current_attempt }}/{{ max_attempts }}
            {% endif %}
        </p>
        {% endif %}

        <p class="passing-score">
            <strong>{% trans "Minimum Passing Score:" %}</strong>
            {{ minimum_passing_score|floatformat:1 }}%
        </p>
    </div>

    <div class="vert-mod {% if not can_submit %}exam-submitted{% endif %}">
        {% for item in items %}
            {% if item.content %}
                <div class="vert vert-{{ forloop.counter0 }}"
                     data-id="{{ item.id }}"
                     id="{{ item.id }}">
                    {{ item.content|safe }}
                </div>
            {% endif %}
        {% endfor %}
    </div>

    <div class="exam-actions">
        {% if can_submit %}
            <button class="btn btn-primary submit-exam-btn"
                    data-usage-id="{{ usage_id }}">
                {% trans "Submit" %}
            </button>
        {% endif %}

        {% if can_retry %}
            <button class="btn btn-warning retry-exam-btn"
                    data-usage-id="{{ usage_id }}">
                {% trans "Retry" %}
            </button>
        {% endif %}
    </div>
</div>

<!-- Retry Confirmation Modal -->
<div id="retry-exam-modal" class="retry-modal" style="display: none;">
    <div class="retry-modal-overlay"></div>
    <div class="retry-modal-content">
        <div class="retry-modal-header">
            <h3>{% trans "Confirm Exam Retry" %}</h3>
            <button class="retry-modal-close">&times;</button>
        </div>
        <div class="retry-modal-body">
            <div class="retry-modal-warning">
                <svg class="warning-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
                </svg>
                <div class="retry-modal-warning-content">
                    <p><strong>{% trans "Please note:" %}</strong></p>
                    <ul class="retry-modal-list">
                        <li>{% trans "Your current score will be removed" %}</li>
                        <li>{% trans "New questions will be randomly generated" %}</li>
                        <li>{% trans "You will start the exam fresh" %}</li>
                    </ul>
                    <p class="retry-modal-confirm">{% trans "Are you sure you want to retry this exam?" %}</p>
                </div>
            </div>
        </div>
        <div class="retry-modal-footer">
            <button class="btn retry-modal-cancel">{% trans "Cancel" %}</button>
            <button class="btn btn-warning retry-modal-confirm-btn">{% trans "Yes, Retry Exam" %}</button>
        </div>
    </div>
</div>
